# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file '.\gui\GUI_Automation.ui'
#
# Created by: PyQt5 UI code generator 5.15.4
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets,Qt
from AboutWindow_GUI import Ui_AboutWindow
import os, fnmatch
class Ui_MainWindow(object):
    def openAboutWindow(self):
        self.window = QtWidgets.QMainWindow()
        self.ui = Ui_AboutWindow()
        self.ui.setupUi(self.window)
        self.window.show()

    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.setEnabled(True)
        MainWindow.resize(600, 379)
        font = QtGui.QFont()
        font.setFamily("Arial")
        font.setPointSize(9)
        font.setBold(False)
        font.setItalic(False)
        font.setWeight(50)
        MainWindow.setFont(font)
        MainWindow.setContextMenuPolicy(QtCore.Qt.DefaultContextMenu)
        MainWindow.setWindowTitle("PO Automation")
        MainWindow.setStyleSheet("")
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.ProcessBtn = QtWidgets.QPushButton(self.centralwidget)
        self.ProcessBtn.setGeometry(QtCore.QRect(320, 280, 93, 28))
        font = QtGui.QFont()
        font.setFamily("Arial")
        font.setPointSize(9)
        self.ProcessBtn.setFont(font)
        self.ProcessBtn.setObjectName("ProcessBtn")
        self.LoadPOBtn = QtWidgets.QPushButton(self.centralwidget)
        self.LoadPOBtn.setGeometry(QtCore.QRect(220, 280, 93, 28))
        font = QtGui.QFont()
        font.setFamily("Arial")
        font.setPointSize(9)
        self.LoadPOBtn.setFont(font)
        self.LoadPOBtn.setObjectName("LoadPOBtn")
        self.LoadPOBtn.clicked.connect(self.loadPO)
        self.LoadTokenBtn = QtWidgets.QPushButton(self.centralwidget)
        self.LoadTokenBtn.setGeometry(QtCore.QRect(120, 280, 93, 28))
        font = QtGui.QFont()
        font.setFamily("Arial")
        font.setPointSize(9)
        self.LoadTokenBtn.setFont(font)
        self.LoadTokenBtn.setObjectName("LoadTokenBtn")
        self.ExportLogBtn = QtWidgets.QPushButton(self.centralwidget)
        self.ExportLogBtn.setGeometry(QtCore.QRect(20, 280, 93, 28))
        font = QtGui.QFont()
        font.setFamily("Arial")
        font.setPointSize(9)
        self.ExportLogBtn.setFont(font)
        self.ExportLogBtn.setObjectName("ExportLogBtn")
        self.OperatorName = QtWidgets.QLineEdit(self.centralwidget)
        self.OperatorName.setGeometry(QtCore.QRect(120, 250, 151, 21))
        self.OperatorName.setClearButtonEnabled(False)
        self.OperatorName.setObjectName("OperatorName")
        self.label = QtWidgets.QLabel(self.centralwidget)
        self.label.setGeometry(QtCore.QRect(60, 250, 61, 21))
        font = QtGui.QFont()
        font.setFamily("Arial")
        font.setPointSize(9)
        font.setBold(False)
        font.setItalic(False)
        font.setWeight(50)
        self.label.setFont(font)
        self.label.setObjectName("label")
        self.listView = QtWidgets.QListView(self.centralwidget)
        self.listView.setGeometry(QtCore.QRect(20, 50, 251, 191))
        self.listView.setObjectName("listView")
        self.model = QtCore.QStringListModel()
        self.label_2 = QtWidgets.QLabel(self.centralwidget)
        self.label_2.setGeometry(QtCore.QRect(20, 20, 61, 16))
        self.label_2.setFont(font)
        self.label_2.setObjectName("label_2")
        self.CurrentDirLabel = QtWidgets.QLabel(self.centralwidget)
        self.CurrentDirLabel.setGeometry(QtCore.QRect(80, 20, 280, 32))
        self.CurrentDirLabel.setAlignment(QtCore.Qt.AlignLeft|QtCore.Qt.AlignTop)
        self.CurrentDirLabel.setFont(font)
        self.CurrentDirLabel.setWordWrap(True)
        self.CurrentDirLabel.setObjectName("CurrentDirLabel")
        MainWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(MainWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 600, 21))
        self.menubar.setObjectName("menubar")
        self.menuMain = QtWidgets.QMenu(self.menubar)
        self.menuMain.setObjectName("menuMain")
        self.menuHelp = QtWidgets.QMenu(self.menubar)
        self.menuHelp.setObjectName("menuHelp")
        MainWindow.setMenuBar(self.menubar)
        self.statusbar = QtWidgets.QStatusBar(MainWindow)
        self.statusbar.setObjectName("statusbar")
        MainWindow.setStatusBar(self.statusbar)
        self.actionLoad_Token = QtWidgets.QAction(MainWindow)
        self.actionLoad_Token.setFont(font)
        self.actionLoad_Token.setObjectName("actionLoad_Token")
        self.actionLoad_Token.triggered.connect(self.loadToken)
        self.actionExport = QtWidgets.QAction(MainWindow)
        self.actionExport.setObjectName("actionExport")
        self.actionClose = QtWidgets.QAction(MainWindow)
        self.actionClose.setObjectName("actionClose")
        self.actionManual = QtWidgets.QAction(MainWindow)
        self.actionManual.setFont(font)
        self.actionManual.setObjectName("actionManual")
        self.actionAbout = QtWidgets.QAction(MainWindow)
        self.actionAbout.setObjectName("actionAbout")
        self.menuMain.addAction(self.actionLoad_Token)
        self.menuMain.addAction(self.actionExport)
        self.menuMain.addSeparator()
        self.menuMain.addAction(self.actionClose)
        self.menuHelp.addAction(self.actionManual)
        self.menuHelp.addSeparator()
        self.menuHelp.addAction(self.actionAbout)
        self.actionAbout.triggered.connect(self.openAboutWindow)
        self.menubar.addAction(self.menuMain.menuAction())
        self.menubar.addAction(self.menuHelp.menuAction())

        self.retranslateUi(MainWindow)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)
        MainWindow.setTabOrder(self.LoadPOBtn, self.ProcessBtn)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        self.ProcessBtn.setText(_translate("MainWindow", "Process"))
        self.LoadPOBtn.setText(_translate("MainWindow", "Load PO"))
        self.LoadTokenBtn.setText(_translate("MainWindow", "Load Token"))
        self.ExportLogBtn.setText(_translate("MainWindow", "Export Log"))
        self.label.setText(_translate("MainWindow", "Operator:"))
        self.label_2.setText(_translate("MainWindow", "Directoy:"))
        self.CurrentDirLabel.setText(_translate("MainWindow", "tmp_dir"))
        self.menuMain.setTitle(_translate("MainWindow", "&Main"))
        self.menuHelp.setTitle(_translate("MainWindow", "Info"))
        self.actionLoad_Token.setText(_translate("MainWindow", "Load Token"))
        self.actionExport.setText(_translate("MainWindow", "Export"))
        self.actionClose.setText(_translate("MainWindow", "Exit"))
        self.actionManual.setText(_translate("MainWindow", "Manual"))
        self.actionAbout.setText(_translate("MainWindow", "About"))

    def loadToken(self):
        fname = QtWidgets.QFileDialog.getOpenFileName(self,'Open file','C:/Users/DLab/source/repos/automation_PO')
        f = open(fname[0],'r',encoding='UTF-8')
        fdata = f.read().split('\n')
        print("file "+fname[0]+" is loaded")
        print(fdata)
        f.close()
    def loadPO(self):
        dirname = QtWidgets.QFileDialog.getExistingDirectory(self,'Select PO folder:','C:/Users/DLab/source/repos/automation_PO')
        listofFiles = os.listdir(dirname)
        print(listofFiles)
        self.model.setStringList(listofFiles)
        self.listView.setModel(self.model)
        self.CurrentDirLabel.setText(repr(dirname[0:]))